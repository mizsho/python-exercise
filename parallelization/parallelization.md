# 並列処理のメモ

## `multiprocessing`

参考になりそうなサイト
- https://note.com/npaka/n/na95cfc0e494d#lumk6

### sleep関数のテスト

意図通り並列的に動作することを確認。

### 座標間の距離を計算する関数のテスト

並列化しない場合より時間がかかってしまう。理由は不明。

並列化すると、複数のコアでCPU使用率が上昇することを確認。

並列化はせずに`Process`を使うだけで2.5s⇒41.5sと大幅に時間がかかってしまう。ndarrayのビューを引数に渡しているので大丈夫と思っていたが、実はメモリが共有できていないため？

## `concurrent`

### sleep関数のテスト

意図通り並列的に動作することを確認。

投入したスレッドが終了するまで待つのに、`as_completed`がうまく機能しない。
`wait`を試したところ待機させることに成功。

### 座標間の距離を計算する関数のテスト

並列化(`max_workers=2`)でわずかに速くなることを確認。
しかし、並列数を増やすと時間がかかってしまう。原因は不明。メモリが共有できておらず新たなメモリを確保する際のオーバーヘッドが律速している？